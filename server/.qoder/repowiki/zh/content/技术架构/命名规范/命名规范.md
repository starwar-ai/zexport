# 命名规范

<cite>
**本文档引用文件**  
- [V1_0_0_003__dms_shipment_plan_item增加唛头相关字段.java](file://eplus-flyway/src/main/java/db/migration/common/V1_0_0_003__dms_shipment_plan_item增加唛头相关字段.java)
- [V1_0_0_175__业务表中增加订单链路编号.java](file://eplus-flyway/src/main/java/db/migration/common/V1_0_0_175__业务表中增加订单链路编号.java)
- [V1_0_0_192__文件表增加初始文件名字段.java](file://eplus-flyway/src/main/java/db/migration/common/V1_0_0_192__文件表增加初始文件名字段.java)
- [ErrorCodeConstants.java](file://eplus-module-crm/eplus-module-crm-api/src/main/java/com/syj/eplus/module/crm/enums/ErrorCodeConstants.java)
- [ErrorCodeConstants.java](file://eplus-module-dms/eplus-module-dms-api/src/main/java/com/syj/eplus/module/dms/enums/ErrorCodeConstants.java)
- [ErrorCodeConstants.java](file://eplus-module-dpms/eplus-module-dpms-api/src/main/java/com/syj/eplus/module/dpms/api/enums/ErrorCodeConstants.java)
- [ErrorCodeConstants.java](file://eplus-module-dtms/eplus-module-dtms-api/src/main/java/com/syj/eplus/module/dtms/api/ErrorCodeConstants.java)
- [ErrorCodeConstants.java](file://eplus-module-ems/eplus-module-ems-api/src/main/java/com/syj/eplus/module/ems/enums/ErrorCodeConstants.java)
- [GlobalErrorCodeConstants.java](file://yudao-framework/yudao-common/src/main/java/cn/iocoder/yudao/framework/common/exception/enums/GlobalErrorCodeConstants.java)
- [CodegenEngine.java](file://yudao-module-infra/yudao-module-infra-biz/src/main/java/cn/iocoder/yudao/module/infra/service/codegen/inner/CodegenEngine.java)
- [CodegenBuilder.java](file://yudao-module-infra/yudao-module-infra-biz/src/main/java/cn/iocoder/yudao/module/infra/service/codegen/inner/CodegenBuilder.java)
- [errorcode.vm](file://yudao-module-infra/yudao-module-infra-biz/src/main/resources/codegen/java/enums/errorcode.vm)
- [SkuServiceImpl.java](file://eplus-module-pms/eplus-module-pms-biz/src/main/java/com/syj/eplus/module/pms/service/sku/SkuServiceImpl.java)
</cite>

## 目录
1. [Java类命名规范](#java类命名规范)  
2. [数据库表命名规范](#数据库表命名规范)  
3. [字段命名规范](#字段命名规范)  
4. [错误码命名规则与分层结构](#错误码命名规则与分层结构)  
5. [Flyway数据库迁移脚本命名规范](#flyway数据库迁移脚本命名规范)  
6. [最佳实践建议](#最佳实践建议)

## Java类命名规范

在eplus-admin-server项目中，Java类的命名遵循模块化、分层清晰的命名约定，主要通过模块前缀与功能后缀相结合的方式进行组织。

- **Controller类**：位于各模块的`controller`包下，通常以`XXXController`结尾，如`ProjectController`。对于管理后台接口，常位于`admin`子包中，如`controller/admin/project/ProjectController.java`。
- **Service类**：接口定义以`XXXService`命名，实现类以`XXXServiceImpl`命名，位于`service`包下。例如`ProjectService`和`ProjectServiceImpl`。
- **Mapper类**：MyBatis映射接口以`XXXMapper`命名，位于`mapper`或`dal.mysql`包下，如`SkuMapper.xml`对应的`SkuMapper`接口。
- **DTO类**：数据传输对象位于`dto`包下，命名体现用途，如`FormChangeDTO`、`DesignSummaryDTO`等。对于转换器，使用`XXXConvert`命名，如`ProjectConvert`。
- **枚举类**：位于`enums`包下，命名体现其所属模块和用途，如`ErrorCodeConstants`、`DesignStatusEnum`等。
- **实体类（DO）**：对应数据库表，位于`dataobject`或`dal.dataobject`包下，命名采用驼峰式，如`SkuDO`、`ShipmentPlanDO`。

此外，项目中存在API接口定义类，通常以`Api`结尾，如`ShipmentApi`，位于`api`包下，用于模块间服务调用。

**本节来源**  
- [eplus-module-pjms-biz/src/main/java/com/syj/eplus/module/pjms/controller/admin/project/ProjectController.java](file://eplus-module-pjms/eplus-module-pjms-biz/src/main/java/com/syj/eplus/module/pjms/controller/admin/project/ProjectController.java)
- [eplus-module-pjms-biz/src/main/java/com/syj/eplus/module/pjms/service/project/ProjectServiceImpl.java](file://eplus-module-pjms/eplus-module-pjms-biz/src/main/java/com/syj/eplus/module/pjms/service/project/ProjectServiceImpl.java)
- [eplus-module-sms/eplus-module-sms-api/src/main/java/com/syj/eplus/module/sms/api/dto/AddSubItemApi.java](file://eplus-module-sms/eplus-module-sms-api/src/main/java/com/syj/eplus/module/sms/api/dto/AddSubItemApi.java)
- [eplus-module-pms/eplus-module-pms-biz/src/main/java/com/syj/eplus/module/pms/convert/project/ProjectConvert.java](file://eplus-module-pms/eplus-module-pms-biz/src/main/java/com/syj/eplus/module/pms/convert/project/ProjectConvert.java)

## 数据库表命名规范

数据库表命名遵循“模块前缀 + 下划线 + 实体名”的模式，采用小写字母和下划线分隔的蛇形命名法（snake_case）。

- **模块前缀**：每个模块使用特定的缩写作为表名前缀，以实现逻辑隔离和避免命名冲突。例如：
  - `sms_`：销售管理模块（Sales Management System）
  - `scm_`：供应链管理模块（Supply Chain Management）
  - `dms_`：出运管理模块（Delivery Management System）
  - `pms_`：产品管理模块（Product Management System）
  - `wms_`：仓库管理模块（Warehouse Management System）
  - `infra_`：基础架构模块（Infrastructure）
- **实体名**：描述表所代表的核心业务实体，如`sale_contract`（销售合同）、`purchase_plan`（采购计划）、`shipment_plan`（出运计划）、`file`（文件）等。

综合示例：
- `sms_sale_contract`：销售合同表
- `scm_purchase_contract`：采购合同表
- `dms_shipment_plan`：出运计划表
- `infra_file`：文件表

这种命名方式清晰地表达了表的归属模块和业务含义，便于跨团队协作和数据库维护。

**本节来源**  
- [V1_0_0_175__业务表中增加订单链路编号.java](file://eplus-flyway/src/main/java/db/migration/common/V1_0_0_175__业务表中增加订单链路编号.java#L13-L20)
- [V1_0_0_192__文件表增加初始文件名字段.java](file://eplus-flyway/src/main/java/db/migration/common/V1_0_0_192__文件表增加初始文件名字段.java#L13)

## 字段命名规范

数据库字段命名严格遵循蛇形命名法（snake_case），即全部小写，单词间用下划线分隔。Java实体类中的字段则采用驼峰命名法（camelCase），两者通过MyBatis等ORM框架进行映射。

- **通用字段**：
  - `id`：主键
  - `create_time`：创建时间
  - `update_time`：更新时间
  - `creator`：创建人
  - `updater`：更新人
  - `deleted`：软删除标记（0-未删除，1-已删除）

- **布尔字段**：
  布尔类型的字段通常以`is_`或`has_`为前缀，明确表达其布尔性质。例如：
  - `is_deleted`：是否已删除
  - `has_children`：是否有子节点
  - `transform_shipment_flag`：是否转出运明细（尽管此例未使用`is_`前缀，但`flag`表明其为标志位）

- **外键字段**：
  外键字段通常以被引用表的主键名命名，如`user_id`、`dept_id`。

- **枚举/状态字段**：
  状态字段以`status`结尾，如`status`、`audit_status`。类型字段以`type`结尾，如`payment_type`。

- **金额/数量字段**：
  金额字段以`amount`结尾，如`total_amount`、`paid_amount`。数量字段以`quantity`或`num`结尾，如`quantity`、`outer_box_num`。

- **文本/备注字段**：
  描述性字段以`description`、`remark`或`memo`结尾。

- **时间字段**：
  时间字段以`time`或`date`结尾，如`sign_back_time`、`sign_back_date`。

在Java代码中，通过工具类（如`StrUtils.snakeToCamel`）实现蛇形到驼峰的转换，确保数据库字段与Java属性的正确映射。

**本节来源**  
- [V1_0_0_003__dms_shipment_plan_item增加唛头相关字段.java](file://eplus-flyway/src/main/java/db/migration/common/V1_0_0_003__dms_shipment_plan_item增加唛头相关字段.java#L17-L25)
- [V1_0_0_192__文件表增加初始文件名字段.java](file://eplus-flyway/src/main/java/db/migration/common/V1_0_0_192__文件表增加初始文件名字段.java#L13)
- [SkuServiceImpl.java](file://eplus-module-pms/eplus-module-pms-biz/src/main/java/com/syj/eplus/module/pms/service/sku/SkuServiceImpl.java#L2615)

## 错误码命名规则与分层结构

项目采用分层的错误码体系，结合全局错误码与模块特定错误码，实现错误信息的统一管理和精准定位。

### 全局错误码
定义在`GlobalErrorCodeConstants`接口中，覆盖系统级通用错误，编码范围为0-999。
- `0`：SUCCESS（成功）
- `400`：BAD_REQUEST（请求参数不正确）
- `401`：UNAUTHORIZED（账号未登录）
- `403`：FORBIDDEN（没有该操作权限）
- `500`：INTERNAL_SERVER_ERROR（系统异常）
- `900`：REPEATED_REQUESTS（重复请求）
- `999`：UNKNOWN（未知错误）

### 模块特定错误码
各业务模块定义自己的`ErrorCodeConstants`接口，继承全局规范，使用五位或六位数字编码，形成分层结构。

#### 编码结构
采用`X_XXX_XX_XXX`或`X_XXX_XXX`的格式，各段含义如下：
- **第一段**：系统标识，如`1`代表主系统。
- **第二段**：模块标识，如`001`代表CRM，`010`代表DMS。
- **第三段**：子模块或功能域标识。
- **第四段**：具体错误编号。

#### 模块示例
- **CRM模块**：使用`1_001_xxx_xxx`段，如`CUST_NOT_EXISTS = 1_001_001_001`（客户资料不存在）。
- **DMS模块**：使用`1_010_xxx_xxx`段，如`SHIPMENT_PLAN_NOT_EXISTS = 1_010_001_002`（出运计划不存在）。
- **DPMS模块**：使用`1_015_xxx_xxx`段，如`REPORT_NOT_EXISTS = 1_015_001_001`（报表不存在）。
- **DTMS模块**：使用`1_011_xxx`段（四位），如`DESIGN_NOT_EXISTS = 1_011_001`（设计任务单不存在）。

错误码以常量形式定义在`ErrorCodeConstants`接口中，每个常量包含唯一的编码和描述信息，支持参数化消息（使用`{}`占位符）。

**本节来源**  
- [GlobalErrorCodeConstants.java](file://yudao-framework/yudao-common/src/main/java/cn/iocoder/yudao/framework/common/exception/enums/GlobalErrorCodeConstants.java)
- [ErrorCodeConstants.java](file://eplus-module-crm/eplus-module-crm-api/src/main/java/com/syj/eplus/module/crm/enums/ErrorCodeConstants.java)
- [ErrorCodeConstants.java](file://eplus-module-dms/eplus-module-dms-api/src/main/java/com/syj/eplus/module/dms/enums/ErrorCodeConstants.java)
- [ErrorCodeConstants.java](file://eplus-module-dpms/eplus-module-dpms-api/src/main/java/com/syj/eplus/module/dpms/api/enums/ErrorCodeConstants.java)
- [ErrorCodeConstants.java](file://eplus-module-dtms/eplus-module-dtms-api/src/main/java/com/syj/eplus/module/dtms/api/ErrorCodeConstants.java)

## Flyway数据库迁移脚本命名规范

Flyway数据库迁移脚本采用严格的版本化命名规则，确保数据库变更的有序执行和可追溯性。

### 命名格式
`V{主版本号}_{次版本号}_{修订号}_{步进号}__{描述}.java`

- **V**：版本标识符，必须大写。
- **主版本号**：代表重大版本更新。
- **次版本号**：代表功能模块更新。
- **修订号**：代表补丁或小版本。
- **步进号**：三位数字，用于同一版本内的多次变更，确保执行顺序。
- **双下划线__**：分隔版本号和描述。
- **描述**：使用中文简要说明变更内容，如“增加唛头相关字段”、“文件表增加初始文件名字段”。
- **扩展名**：`.java`，表示使用Java编写的迁移脚本。

### 示例
- `V1_0_0_003__dms_shipment_plan_item增加唛头相关字段.java`
- `V1_0_0_175__业务表中增加订单链路编号.java`
- `V1_0_0_192__文件表增加初始文件名字段.java`

这种命名方式确保了：
1. **顺序执行**：Flyway按文件名的字典序执行脚本。
2. **清晰可读**：版本号和描述清晰地表达了变更的上下文。
3. **团队协作**：避免命名冲突，便于多人协作开发。

**本节来源**  
- [V1_0_0_003__dms_shipment_plan_item增加唛头相关字段.java](file://eplus-flyway/src/main/java/db/migration/common/V1_0_0_003__dms_shipment_plan_item增加唛头相关字段.java)
- [V1_0_0_175__业务表中增加订单链路编号.java](file://eplus-flyway/src/main/java/db/migration/common/V1_0_0_175__业务表中增加订单链路编号.java)
- [V1_0_0_192__文件表增加初始文件名字段.java](file://eplus-flyway/src/main/java/db/migration/common/V1_0_0_192__文件表增加初始文件名字段.java)

## 最佳实践建议

为确保eplus-admin-server项目的代码一致性和可读性，提出以下命名规范最佳实践：

1. **严格遵守模块前缀**：所有数据库表、Java包、API路径都应使用统一的模块前缀，避免命名冲突，增强模块边界清晰度。

2. **统一错误码管理**：新模块的错误码应申请独立的编码段，并在`ErrorCodeConstants`接口中集中定义。错误消息应清晰、用户友好，并支持国际化。

3. **自动化命名转换**：利用`StrUtils.snakeToCamel`等工具类，确保数据库蛇形命名与Java驼峰命名之间的无缝转换，减少手动映射错误。

4. **Flyway脚本版本控制**：在团队协作中，应提前规划版本号，避免多人同时提交相同版本的脚本。描述部分应简洁明了，便于后期审计。

5. **代码生成器利用**：项目中的代码生成器（如`CodegenBuilder`）已内置命名规则，应优先使用生成器创建新模块或表的代码骨架，保证命名一致性。

6. **文档化约定**：将本文档作为团队开发规范，纳入新成员培训材料，确保所有开发者对命名规则有统一理解。

7. **定期审查**：在代码评审（Code Review）中，将命名规范作为重要检查项，及时纠正不符合规范的命名。

通过遵循这些最佳实践，可以显著提升代码库的可维护性、可读性和团队协作效率。

**本节来源**  
- [CodegenBuilder.java](file://yudao-module-infra/yudao-module-infra-biz/src/main/java/cn/iocoder/yudao/module/infra/service/codegen/inner/CodegenBuilder.java)
- [CodegenEngine.java](file://yudao-module-infra/yudao-module-infra-biz/src/main/java/cn/iocoder/yudao/module/infra/service/codegen/inner/CodegenEngine.java)
- [errorcode.vm](file://yudao-module-infra/yudao-module-infra-biz/src/main/resources/codegen/java/enums/errorcode.vm)