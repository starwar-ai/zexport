# 数据库命名规范

<cite>
**本文档引用的文件**   
- [V1_0_0_001__框架初始化.sql](file://eplus-flyway/src/main/resources/db/migration/common/V1_0_0_001__框架初始化.sql)
- [V1_0_0_002__Eplus初始化.sql](file://eplus-flyway/src/main/resources/db/migration/common/V1_0_0_002__Eplus初始化.sql)
- [V1_0_0_005__新建银行登记表.sql](file://eplus-flyway/src/main/resources/db/migration/common/V1_0_0_005__新建银行登记表.sql)
- [V1_0_0_011__新建收款对象表.sql](file://eplus-flyway/src/main/resources/db/migration/common/V1_0_0_011__新建收款对象表.sql)
- [V1_0_0_013__新增客户认领明细表.sql](file://eplus-flyway/src/main/resources/db/migration/common/V1_0_0_013__新增客户认领明细表.sql)
- [V1_0_0_026__新增开票通知表.sql](file://eplus-flyway/src/main/resources/db/migration/common/V1_0_0_026__新增开票通知表.sql)
- [V1_0_0_037__新建付款申请相关表.sql](file://eplus-flyway/src/main/resources/db/migration/common/V1_0_0_037__新建付款申请相关表.sql)
- [V1_0_0_042__新增采购跟单登记表.sql](file://eplus-flyway/src/main/resources/db/migration/common/V1_0_0_042__新增采购跟单登记表.sql)
- [V1_0_0_073__付款相关表.sql](file://eplus-flyway/src/main/resources/db/migration/common/V1_0_0_073__付款相关表.sql)
- [V1_0_0_095__新建报表模块相关基础表.sql](file://eplus-flyway/src/main/resources/db/migration/common/V1_0_0_095__新建报表模块相关基础表.sql)
</cite>

## 目录
1. [表名命名规范](#表名命名规范)
2. [字段命名规范](#字段命名规范)
3. [索引与约束命名规范](#索引与约束命名规范)
4. [视图与存储过程命名约定](#视图与存储过程命名约定)
5. [Flyway迁移脚本中的最佳实践](#flyway迁移脚本中的最佳实践)

## 表名命名规范

根据项目中的Flyway迁移脚本，eplus-admin-server的数据库表名遵循以下规范：

1.  **前缀规范**：表名使用模块缩写作为前缀，以区分不同业务模块。常见的前缀包括：
    *   `system_`：系统模块，如 `system_dept`（部门表）、`system_users`（用户信息表）
    *   `crm_`：客户关系管理模块，如 `crm_cust`（客户资料表）、`crm_cust_poc`（客户联系人表）
    *   `fms_`：财务模块，如 `fms_bank_registration`（银行登记表）、`fms_payee`（收款对象表）
    *   `scm_`：供应链管理模块，如 `scm_invoicing_notices`（开票通知表）、`scm_payment_apply`（付款申请主表）
    *   `dpms_`：报表模块，如 `dpms_report`（报表配置表）
    *   `bpm_`：工作流模块，如 `bpm_process_definition_ext`（流程定义拓展表）

2.  **大小写约定**：所有表名均采用**全小写**，单词之间使用**下划线分隔**（snake_case）。例如：`system_user_role`、`scm_purchase_registration_item`。

3.  **语义化要求**：表名应具有明确的业务语义，能够清晰地表达其存储的数据内容。通常采用“模块_实体”或“模块_实体_子实体”的命名方式。例如：
    *   `system_dept`：系统模块的部门实体。
    *   `scm_payment_apply_item`：供应链模块的付款申请子表（明细）。

**Section sources**
- [V1_0_0_001__框架初始化.sql](file://eplus-flyway/src/main/resources/db/migration/common/V1_0_0_001__框架初始化.sql#L10-L28)
- [V1_0_0_002__Eplus初始化.sql](file://eplus-flyway/src/main/resources/db/migration/common/V1_0_0_002__Eplus初始化.sql#L8-L23)
- [V1_0_0_005__新建银行登记表.sql](file://eplus-flyway/src/main/resources/db/migration/common/V1_0_0_005__新建银行登记表.sql#L1-L36)
- [V1_0_0_011__新建收款对象表.sql](file://eplus-flyway/src/main/resources/db/migration/common/V1_0_0_011__新建收款对象表.sql#L1-L23)
- [V1_0_0_026__新增开票通知表.sql](file://eplus-flyway/src/main/resources/db/migration/common/V1_0_0_026__新增开票通知表.sql#L1-L62)

## 字段命名规范

数据库字段的命名遵循清晰、一致的原则，具体规范如下：

1.  **命名风格**：与表名一致，字段名也采用**全小写+下划线分隔**的风格（snake_case），不使用驼峰命名法。例如：`user_id`、`create_time`、`bank_account`。

2.  **主键字段**：主键字段统一命名为 `id`。例如，在 `system_dept` 表中，主键为 `id`。

3.  **外键字段**：外键字段的命名采用“关联表名 + _id”的方式。例如：
    *   在 `system_user_role` 表中，关联用户表的外键为 `user_id`。
    *   在 `scm_payment_apply` 表中，关联供应商的外键为 `vender_id`。
    *   在 `crm_cust_poc` 表中，关联客户的外键为 `cust_id`。

4.  **布尔/状态字段**：
    *   布尔值或状态字段通常使用 `is_` 或 `flag` 作为前缀，但根据代码库，更常见的是直接使用描述性名称并配合注释说明其含义。
    *   例如，`deleted` 字段（是否删除），其类型为 `bit(1)`，值为 `b'0'` 表示未删除。
    *   `default_flag` 字段（是否默认账户）。
    *   `enable_flag` 字段（是否启用）。
    *   `completed_flag` 字段（收款完成标识）。
    *   状态字段如 `status`、`audit_status`、`print_flag` 等，通过注释（COMMENT）来定义其具体含义（如0正常，1停用）。

5.  **时间戳字段**：创建和更新时间字段有固定的命名：
    *   `create_time`：创建时间。
    *   `update_time`：更新时间，并通常设置 `ON UPDATE CURRENT_TIMESTAMP` 自动更新。

6.  **创建/更新人字段**：记录操作者的字段：
    *   `creator`：创建者。
    *   `updater`：更新者。

**Section sources**
- [V1_0_0_001__框架初始化.sql](file://eplus-flyway/src/main/resources/db/migration/common/V1_0_0_001__框架初始化.sql#L13-L27)
- [V1_0_0_002__Eplus初始化.sql](file://eplus-flyway/src/main/resources/db/migration/common/V1_0_0_002__Eplus初始化.sql#L51-L90)
- [V1_0_0_013__新增客户认领明细表.sql](file://eplus-flyway/src/main/resources/db/migration/common/V1_0_0_013__新增客户认领明细表.sql#L3-L30)
- [V1_0_0_037__新建付款申请相关表.sql](file://eplus-flyway/src/main/resources/db/migration/common/V1_0_0_037__新建付款申请相关表.sql#L4-L36)

## 索引与约束命名规范

项目中对索引和约束的命名遵循了MySQL的默认规则，未使用自定义的命名规范。

1.  **主键约束**：主键约束使用默认名称 `PRIMARY`。
2.  **唯一索引**：唯一索引在创建时会指定名称，通常为 `idx_字段名` 或 `uk_字段名`。例如，在 `system_users` 表中，有一个名为 `idx_username` 的唯一索引。
3.  **普通索引**：普通索引也使用 `idx_` 作为前缀，后跟字段名。例如，在 `member_address` 表中，有 `idx_userId` 索引。
4.  **外键约束**：外键约束使用了默认的命名方式，由系统自动生成。例如，在 `act_ge_bytearray` 表中，外键约束名为 `ACT_FK_BYTEARR_DEPL`。

**Section sources**
- [V1_0_0_001__框架初始化.sql](file://eplus-flyway/src/main/resources/db/migration/common/V1_0_0_001__框架初始化.sql#L70-L71)
- [V1_0_0_001__框架初始化.sql](file://eplus-flyway/src/main/resources/db/migration/common/V1_0_0_001__框架初始化.sql#L759-L762)
- [V1_0_0_001__框架初始化.sql](file://eplus-flyway/src/main/resources/db/migration/common/V1_0_0_001__框架初始化.sql#L151-L152)

## 视图与存储过程命名约定

在当前分析的Flyway迁移脚本中，主要关注的是表结构的创建（`CREATE TABLE`），并未发现视图（VIEW）或存储过程（PROCEDURE）的定义。因此，基于现有代码库，无法总结出关于视图和存储过程的具体命名约定。

## Flyway迁移脚本中的最佳实践

结合Flyway迁移脚本的内容，可以总结出以下数据库设计和管理的最佳实践：

1.  **模块化前缀**：使用清晰的模块前缀（如 `system_`, `fms_`, `scm_`）是组织大型数据库的有效方式，它能快速定位表所属的业务领域，避免命名冲突。

2.  **统一的审计字段**：几乎所有表都包含了一套标准的审计字段，这极大地提升了数据的可追溯性：
    *   `create_time` 和 `update_time`：精确记录数据的生命周期。
    *   `creator` 和 `updater`：明确数据的操作责任人。
    *   `deleted`：实现逻辑删除，保障数据安全。

3.  **数据类型选择**：
    *   **主键**：普遍使用 `bigint` 类型，确保了ID的充足性和性能。
    *   **状态/类型字段**：大量使用 `tinyint` 来存储枚举值或状态码，节省存储空间。
    *   **金额字段**：使用 `decimal(19, 6)` 精确存储金额，避免浮点数计算误差。
    *   **JSON字段**：对于结构不固定或需要存储对象的数据（如 `address_shipping`, `manager`, `annex`），使用 `json` 数据类型，提供了极大的灵活性。

4.  **注释（COMMENT）的充分使用**：每个表和字段都配有详细的中文注释，这对于团队协作和后期维护至关重要，使得数据库结构一目了然。

5.  **逻辑删除**：通过 `deleted` 字段（`bit(1)`）实现逻辑删除，而不是物理删除数据，这是一种安全且常见的做法。

6.  **迁移脚本的幂等性**：脚本中使用了 `CREATE TABLE IF NOT EXISTS` 和 `DROP TABLE IF EXISTS` 语句，这表明迁移脚本被设计为可以重复执行，增强了部署的健壮性。

**Section sources**
- [V1_0_0_001__框架初始化.sql](file://eplus-flyway/src/main/resources/db/migration/common/V1_0_0_001__框架初始化.sql)
- [V1_0_0_002__Eplus初始化.sql](file://eplus-flyway/src/main/resources/db/migration/common/V1_0_0_002__Eplus初始化.sql)
- [V1_0_0_073__付款相关表.sql](file://eplus-flyway/src/main/resources/db/migration/common/V1_0_0_073__付款相关表.sql)